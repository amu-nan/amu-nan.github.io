<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xforia COAST - RIA Assistant</title>
    <link rel="icon" type="image/png" href="../../images/Subject.png">
    
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="../../css/manufacturing/conversation-ai.css">
</head>
<body>

    <main class="dashboard-main">
        <div class="dashboard-container">
            
            <div class="welcome-section">
                <div class="welcome-content">
                    <div class="welcome-text">
                        <h1><span id="companyNameDisplay">Xforia</span> RIA</h1>
                        <p>Your AI-Powered Manufacturing Assistant.</p>
                    </div>
                    <div class="logo-badge">
                        <img src="../../images/logo.png" alt="Xforia Logo" style="height:45px;">
                    </div>
                </div>
            </div>

            <div class="chatbot-wrapper">
                <div id="chatbot-widget-root"></div>
            </div>

            <div class="logout-section">
                <a href="admin-dashboard.html" class="logout-btn">
                    <i class="fa-solid fa-arrow-left"></i> Back to Dashboard
                </a>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Xforia COAST - All Rights Reserved.</p>
    </footer>

    <script src="../../js/chatbot.js"></script> 
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Fix Dynamic Company Name
            const companyDisplay = document.getElementById('companyNameDisplay');
            const savedName = localStorage.getItem('companyName') || sessionStorage.getItem('orgName');
            if (companyDisplay && savedName) companyDisplay.textContent = savedName;

            // Initialize the React Widget
            if (window.initChatbot) {
                window.initChatbot({
                    embedded: true,
                    theme: 'light',
                    greeting: "Hi! What can I do for you?",
                    apiUrl: "http://127.0.0.1:8001/api/v1",
                    responseField: "response", // Correct field for your backend
                    preferResponseField: true,  // Force it to ignore "I heard" type headers
                    mode: "text"
                });
            }
        });
    </script>
</body>
</html>