<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organize - Xforia</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <header>
        <div class="logo-container">
            <img src="../images/logo.png" alt="Xforia COAST Logo" class="logo">
            <span class="tagline">Your tagline goes here.</span>
        </div>
        <div class="coast-flow-header">
            <div class="coast-step-container">
                <span class="coast-letter">C</span>
                <span class="coast-step-name"></span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter active">O</span>
                <span class="coast-step-name active">Organize</span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter">A</span>
                <span class="coast-step-name"></span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter">S</span>
                <span class="coast-step-name"></span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter">T</span>
                <span class="coast-step-name"></span>
            </div>
        </div>
    </header>

    <main class="organize-page">
        <section class="organize-content">
            <h2 class="page-title">Organize - Tell us about your organization</h2>
            <p class="page-description">Provide some basic information to help us structure your data.</p>
            
            <div class="organize-form-container">
                <div class="input-group">
                    <label for="org-name">Name of Organization:</label>
                    <input type="text" id="org-name" placeholder="e.g., General Hospital">
                </div>
                
                <div class="input-group">
                    <label for="org-type">Choose Type of Organization:</label>
                    <select id="org-type">
                        <option value="healthcare" selected>Healthcare</option>
                        <option value="retail" disabled>Retail (Coming Soon)</option>
                        <option value="academic" disabled>Academic (Coming Soon)</option>
                    </select>
                </div>
                
                <div class="entities-container">
                    <p>Display all possible entities to choose from:</p>
                    <div class="entity-list">
                        <div class="entity-item mandatory" data-entity="owner">Owner</div>
                        <div class="entity-item mandatory" data-entity="nurse">Nurse</div>
                        <div class="entity-item mandatory" data-entity="patient">Patient</div>
                        <div class="entity-item mandatory" data-entity="relative">Relative</div>
                        <div class="entity-item optional" data-entity="casemanager">Case Manager</div>
                        <div class="entity-item optional" data-entity="socialworker">Social Worker</div>
                        <div class="entity-item optional" data-entity="specialist">Specialist</div>
                    </div>
                </div>
            </div>

            <button id="continue-btn" class="continue-button">Continue</button>
        </section>
    </main>
    
    <script src="../js/scripts.js"></script>
    <script>
        const continueBtn = document.getElementById('continue-btn');
        const orgNameInput = document.getElementById('org-name');
        const entityItems = document.querySelectorAll('.entity-item');
        let selectedEntities = [];

        // Toggle selected entities
        entityItems.forEach(item => {
            item.addEventListener('click', () => {
                const entity = item.getAttribute('data-entity');
                if (item.classList.contains('active')) {
                    item.classList.remove('active');
                    selectedEntities = selectedEntities.filter(e => e !== entity);
                } else {
                    item.classList.add('active');
                    selectedEntities.push(entity);
                }
            });
        });
        
        // Initial selection of mandatory entities
        const mandatoryEntities = document.querySelectorAll('.entity-item.mandatory');
        mandatoryEntities.forEach(item => {
            item.classList.add('active');
            selectedEntities.push(item.getAttribute('data-entity'));
        });

        // Handle navigation and data storage
        continueBtn.addEventListener('click', () => {
            const orgName = orgNameInput.value;
            const orgType = document.getElementById('org-type').value;

            if (orgName.trim() === '') {
                alert('Please enter a name for your organization.');
                return;
            }

            const pageData = {
                organizationName: orgName,
                organizationType: orgType,
                selectedEntities: selectedEntities
            };

            sessionStorage.setItem('organizeData', JSON.stringify(pageData));
            window.location.href = 'rbac.html';
        });
    </script>

</body>
</html>
