<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RBAC - Xforia</title>
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/rbac.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/png" href="../images/Subject.png">
</head>
<body>

    <header>
        <div class="logo-container">
            <img src="../images/logo.png" alt="Xforia COAST Logo" class="logo">
            <span class="tagline">Your tagline goes here.</span>
        </div>
        <div class="coast-flow-header">
            <div class="coast-step-container">
                <span class="coast-letter">C</span>
                <span class="coast-step-name"></span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter">O</span>
                <span class="coast-step-name"></span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter active">A</span>
                <span class="coast-step-name active">Access Control</span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter">S</span>
                <span class="coast-step-name"></span>
            </div>
            <div class="coast-step-container">
                <span class="coast-letter">T</span>
                <span class="coast-step-name"></span>
            </div>
        </div>
    </header>

    <main class="rbac-page">
        <section class="rbac-container">
            <h2>Role-Based Access Control</h2>
            <div class="rbac-form">
                <div class="input-group">
                    <label>Please select the role you will be acting as:</label>
                    <div class="entity-bubbles" id="entity-bubbles">
                        </div>
                </div>
                <button id="continue-btn" class="continue-button">Continue</button>
            </div>
        </section>
    </main>

    <script src="../js/scripts.js"></script>
    <script>
        const entityBubblesContainer = document.getElementById('entity-bubbles');
        const continueBtn = document.getElementById('continue-btn');
        let selectedFinalEntity = null;

        const selectedEntities = JSON.parse(sessionStorage.getItem('selectedEntities')) || [];

        // Dynamic creation of entity bubbles
        selectedEntities.forEach(entity => {
            const bubble = document.createElement('div');
            bubble.classList.add('bubble');
            bubble.textContent = entity.charAt(0).toUpperCase() + entity.slice(1);
            bubble.dataset.entity = entity;
            
            bubble.addEventListener('click', () => {
                // Remove 'selected' class from all bubbles
                document.querySelectorAll('.bubble').forEach(b => b.classList.remove('selected'));
                
                // Add 'selected' class to the clicked bubble
                bubble.classList.add('selected');
                selectedFinalEntity = entity;
            });
            
            entityBubblesContainer.appendChild(bubble);
        });

        continueBtn.addEventListener('click', () => {
            if (selectedFinalEntity) {
                sessionStorage.setItem('selectedFinalEntity', selectedFinalEntity);
                window.location.href = 'search.html';
            } else {
                alert('Please select a role to continue.');
            }
        });
    </script>
</body>
</html>
